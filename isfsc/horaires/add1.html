<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ajouter l'horaire au calendrier</title>
    <style>
        body {
            background-color: #283c33;
            color: #fff;
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        h1 { font-size: 2em; margin-bottom: 20px; }
        select, button {
            background-color: #6fb98f;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 10px;
            font-size: 16px;
            cursor: pointer;
        }
        select:hover, button:hover { background-color: #4e8c6f; }
        #languageSelector { align-self: flex-end; }
    </style>
</head>
<body>
    <div id="languageSelector">
        <select id="langSelect" onchange="setLanguage(this.value)">
            <option value="fr">Français</option>
            <option value="en">English</option>
            <option value="nl">Nederlands</option>
            <option value="de">Deutsch</option>
        </select>
    </div>
    <h1 id="title">Ajouter l'horaire au calendrier</h1>
    <button id="downloadICS">Télécharger le fichier ICS</button>
    <button id="googleCalendar">Ajouter à Google Calendar</button>

    <script>
    const icalData = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//hacksw/handcal//NONSGML v1.0//EN
CALSCALE:GREGORIAN
BEGIN:VEVENT
SUMMARY:Langage, écriture et techniques journalistiques
DTSTART:20241003T100000
DTEND:20241003T130000
LOCATION:local 01
END:VEVENT
BEGIN:VEVENT
SUMMARY:Sociologie générale
DTSTART:20241007T090000
DTEND:20241007T110000
LOCATION:local 01
END:VEVENT
BEGIN:VEVENT
SUMMARY:Exploration des cultures musicales
DTSTART:20241007T110000
DTEND:20241007T130000
LOCATION:local 01
END:VEVENT
BEGIN:VEVENT
SUMMARY:Activité spéciale - VAN CAUBERG Nathalie
DTSTART:20241007T130000
DTEND:20241007T140000
LOCATION:local 08
END:VEVENT
BEGIN:VEVENT
SUMMARY:Langage, écriture et techniques journalistiques
DTSTART:20241007T140000
DTEND:20241007T160000
LOCATION:Point Poste
END:VEVENT
BEGIN:VEVENT
SUMMARY:Théories de la communication
DTSTART:20241007T160000
DTEND:20241007T180000
LOCATION:Point Poste
END:VEVENT
BEGIN:VEVENT
SUMMARY:Communication interpersonnelle et dynamique de groupe
DTSTART:20241008T110000
DTEND:20241008T130000
LOCATION:local 45
END:VEVENT
BEGIN:VEVENT
SUMMARY:Psychologie et communication
DTSTART:20241008T140000
DTEND:20241008T170000
LOCATION:Auditoire 156
END:VEVENT
BEGIN:VEVENT
SUMMARY:Stratégies de la communication
DTSTART:20241009T090000
DTEND:20241009T110000
LOCATION:Auditoire 156
END:VEVENT
BEGIN:VEVENT
SUMMARY:Histoire des arts contemporains & du design
DTSTART:20241009T110000
DTEND:20241009T130000
LOCATION:Auditoire 156
END:VEVENT
BEGIN:VEVENT
SUMMARY:Atelier d'écriture
DTSTART:20241009T140000
DTEND:20241009T160000
LOCATION:local 31
END:VEVENT
BEGIN:VEVENT
SUMMARY:Recherche documentaire et veille médiatique
DTSTART:20241009T160000
DTEND:20241009T180000
LOCATION:Salle informatique 13
END:VEVENT
END:VCALENDAR`;

    const languages = {
        'fr': {
            title: 'Ajouter l'horaire au calendrier',
            downloadICS: 'Télécharger le fichier ICS',
            googleCalendar: 'Ajouter à Google Calendar'
        },
        'en': {
            title: 'Add schedule to calendar',
            downloadICS: 'Download ICS file',
            googleCalendar: 'Add to Google Calendar'
        },
        'nl': {
            title: 'Voeg rooster toe aan agenda',
            downloadICS: 'Download ICS-bestand',
            googleCalendar: 'Toevoegen aan Google Agenda'
        },
        'de': {
            title: 'Zeitplan zum Kalender hinzufügen',
            downloadICS: 'ICS-Datei herunterladen',
            googleCalendar: 'Zu Google Kalender hinzufügen'
        }
    };

    function setLanguage(lang) {
        const content = languages[lang];
        document.getElementById('title').textContent = content.title;
        document.getElementById('downloadICS').textContent = content.downloadICS;
        document.getElementById('googleCalendar').textContent = content.googleCalendar;
        document.documentElement.lang = lang;
    }

    function detectLanguage() {
        const userLang = navigator.language || navigator.userLanguage;
        const shortLang = userLang.split('-')[0];
        return languages[shortLang] ? shortLang : 'fr';
    }

    document.getElementById('downloadICS').addEventListener('click', function() {
        const blob = new Blob([icalData], { type: 'text/calendar;charset=utf-8' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'horaire_cours.ics';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    });

    document.getElementById('googleCalendar').addEventListener('click', function() {
        const events = icalData.split('BEGIN:VEVENT').slice(1);
        let googleCalendarUrl = 'https://www.google.com/calendar/render?action=TEMPLATE';
        
        events.forEach((event, index) => {
            const summary = event.match(/SUMMARY:(.*)/)[1];
            const start = event.match(/DTSTART:(.*)/)[1];
            const end = event.match(/DTEND:(.*)/)[1];
            const location = event.match(/LOCATION:(.*)/)[1];
            
            googleCalendarUrl += `&text=${encodeURIComponent(summary)}`;
            googleCalendarUrl += `&dates=${start}/${end}`;
            googleCalendarUrl += `&location=${encodeURIComponent(location)}`;
            
            if (index < events.length - 1) {
                googleCalendarUrl += '&action=TEMPLATE';
            }
        });
        
        window.open(googleCalendarUrl, '_blank');
    });

    // Set initial language
    setLanguage(detectLanguage());
    </script>
</body>
</html>
